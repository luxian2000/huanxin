# QAE083: 混合经典-量子编码解码神经网络

## 1. 项目概述

QAE083是一个创新的混合经典-量子编码解码神经网络，结合了经典深度学习和量子计算的优势，专门用于信道状态信息(CSI)数据的压缩与重构。

### 1.1 核心理念
- **经典编码器**: 基于CsiNet架构的经典神经网络，负责初步特征提取和维度压缩
- **量子解码器**: 利用参数化量子线路进行精细的信息处理和重构
- **混合架构**: 充分发挥经典计算的稳定性和量子计算的并行性

## 2. 网络架构设计

### 2.1 整体数据流
```
输入(2560维) → 经典编码器 → 256维 → 量子态嵌入 → 量子解码器 → 多基测量(24维) → 经典解码器 → 输出(2560维)
```

### 2.2 经典编码器 (ClassicalEncoder)
- **输入维度**: 2560维CSI数据
- **输出维度**: 256维压缩表示
- **网络结构**:
  - Linear(2560→1024) + LeakyReLU + Dropout(0.1)
  - Linear(1024→512) + LeakyReLU + Dropout(0.1)  
  - Linear(512→256) + Tanh
- **特点**: 无BatchNorm层，避免单样本训练问题

### 2.3 量子态映射
- **幅度嵌入**: 将256维经典向量归一化后映射到8量子比特的量子态
- **量子比特数**: 8 qubits (足以表示256维空间)
- **归一化处理**: 确保量子态的物理有效性

### 2.4 量子解码器 (quantum_decoder_circuit)
- **量子线路**: StronglyEntanglingLayers (4层)
- **测量策略**: 多基测量 (PauliX, PauliY, PauliZ)
- **输出维度**: 24维 (8 qubits × 3 measurement bases)
- **量子门**: 旋转门和受控门组合的参数化量子线路

### 2.5 经典解码器 (QuantumToClassicalDecoder)
- **输入维度**: 24维量子测量结果
- **输出维度**: 2560维重构数据
- **网络结构**:
  - Linear(24→128) + LeakyReLU + Dropout(0.1)
  - Linear(128→256) + LeakyReLU + Dropout(0.1)
  - Linear(256→512) + LeakyReLU + Dropout(0.1)
  - Linear(512→1024) + LeakyReLU + Dropout(0.1)
  - Linear(1024→2560) + Tanh
- **特点**: 无BatchNorm层，确保训练稳定性

## 3. 训练配置

### 3.1 数据集配置
- **数据源**: `/Users/luxian/DataSpace/csi_cmri/CSI_channel_30km.npy`
- **数据划分**: 
  - 训练集: 56,000样本 (70%)
  - 验证集: 12,000样本 (15%)
  - 测试集: 12,000样本 (15%)
- **训练样本**: 1,000样本（随机采样）

### 3.2 训练参数
- **epochs**: 120
- **batch_size**: 20
- **学习率**: 
  - 经典参数: 0.001
  - 量子参数: 0.01
- **优化器**: Adam
- **损失函数**: MSE (均方误差)

### 3.3 量子参数配置
- **量子比特数**: 8
- **电路层数**: 4
- **参数初始化**: 随机初始化 × 0.1
- **参数类型**: nn.Parameter确保可优化

## 4. 技术创新点

### 4.1 混合架构优势
1. **经典预处理**: 利用成熟的深度学习技术进行特征提取
2. **量子精处理**: 发挥量子计算在信息处理方面的独特优势
3. **互补性设计**: 经典和量子部分各司其职，避免直接竞争

### 4.2 多基测量策略
- **信息完整性**: 通过X、Y、Z三个基的测量获取完整的量子态信息
- **冗余设计**: 提供更多信息用于经典解码器的重构
- **鲁棒性**: 减少单一测量基带来的不确定性

### 4.3 训练稳定性优化
- **无BatchNorm设计**: 避免单样本训练时的统计问题
- **分离优化**: 经典和量子参数分别优化
- **模式管理**: 正确的训练/评估模式切换

## 5. 实验结果分析

### 5.1 训练进展
从初始训练数据可以看出：
- **损失下降**: 从0.0005降至约0.000004，下降超过100倍
- **收敛趋势**: 损失值持续稳定下降
- **参数更新**: 量子参数范数从0.63增长到约0.71，表明有效学习

### 5.2 性能指标
- **训练MSE**: 持续改善中
- **验证MSE**: 待完整训练周期完成后评估
- **重构质量**: 通过MSE衡量重构精度

## 6. 文件结构说明

### 6.1 源代码文件
- `QAE083.py`: 主要实现文件，包含完整网络架构和训练逻辑

### 6.2 训练输出目录 (QAE083/)
- **模型权重文件**:
  - `initial_*.pt`: 初始参数
  - `*_epoch_*.pt`: 各epoch权重快照
  - `final_*.pt`: 最终训练权重
- **训练记录**:
  - `hybrid_batch_losses.csv`: 批次级别损失记录
  - `training_history.pt`: 完整训练历史

### 6.3 设计特点
- **模块化设计**: 各组件独立实现，便于调试和改进
- **可扩展性**: 架构设计支持未来扩展和改进
- **标准化输出**: 符合项目统一的文件组织规范

## 7. 未来改进方向

### 7.1 架构优化
- **更深的量子线路**: 增加量子电路层数提升表达能力
- **注意力机制**: 引入量子注意力机制增强关键特征处理
- **残差连接**: 添加混合残差连接提高训练稳定性

### 7.2 训练策略
- **自适应学习率**: 实施学习率调度器
- **早停机制**: 基于验证性能的智能停止
- **数据增强**: 增加训练数据多样性

### 7.3 性能提升
- **批量处理优化**: 改进量子电路的批量执行效率
- **梯度优化**: 实施梯度裁剪和正则化策略
- **硬件加速**: 探索GPU/量子处理器协同计算

## 8. 总结

QAE083成功实现了经典深度学习与量子计算的有机结合，展示了混合计算架构在CSI数据处理中的巨大潜力。通过精心设计的网络架构和稳定的训练策略，该模型为量子机器学习在实际应用中的落地提供了有价值的参考和实践经验。